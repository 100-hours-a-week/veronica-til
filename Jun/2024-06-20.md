# TIL Template

# ë‚ ì§œ: 2024-06-20

# ìŠ¤í¬ëŸ¼
- âœ… ì˜¤ëŠ˜ í• ì¼ : ìˆ˜ì—…ë“£ê¸°
- ğŸ™€ ì˜ˆìƒ ì´ìŠˆ : awsê´€ë ¨
- ğŸ€ ì‘ì¼ íšŒê³  : ë– ë“¤ìŒ.  ì§‘ì¤‘ìš”ë§

# today issue
- ì—†ìŒ

### ë°°í¬ ì„¸íŒ…
## 1. [start.spring.io](http://start.spring.io) ì—ì„œ ìŠ¤í”„ë§ ì„¸íŒ…í•˜ê³  ë‹¤ìš´ë¡œë“œ (í´ë”ëª… : demo)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 9.39.36.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/b128c7e9-14ff-40d8-8de7-29d51001b5f1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.39.36.png)

## 2. HelloWorldcontroller ì¶”ê°€

getmappingì—ëŠ” í¼ë¸”ë¦­ IPv4 ì£¼ì†Œ ë’¤ì— ë“¤ì–´ê°ˆ ê²½ë¡œ ì§€ì •
ë‚˜ëŠ” ë‹¤ìš´ë¡œë“œí•œ í´ë” ì´ë¦„ì´ demoë¼ì„œ ì´ ê²½ë¡œë¡œ ì§€ì •í•¨

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 9.41.47.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/ddad009c-a45a-48a5-8ac2-28c4b3c70bb4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.41.47.png)

## 3. í¬íŠ¸ë¥¼ 8090ìœ¼ë¡œ ë„ìš¸ê±°ë¼ì„œ propertiesì— ì„œë²„ í¬íŠ¸ ë²ˆí˜¸ ì…ë ¥

(ì•ˆí•´ë„ ë¨)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 9.42.54.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/cbc5ba8c-d197-4cf3-b5fc-72d145930498/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.42.54.png)

## 4. ë¹Œë“œ

í˜„ì¬ demoíŒŒì¼ì˜ ìœ„ì¹˜ : `/User/park-yeonju/Downloads/demo`

ê·¸ë˜ë“¤ buildí•˜ê¸°

```bash
park-yeonju@bag-yeonjuui-noteubug demo % ./gradlew build
```

ë¹Œë“œí•˜ë©´ jaríŒŒì¼ ìƒê¹€(ê²½ë¡œëŠ” ì•„ë˜ ì°¸ì¡°)

jar íŒŒì¼ : `/User/park-yeonju/Downloads/demo/build/libs/`

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 9.44.54.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/1770cf4b-7c2d-42e5-bfda-27e4f86e902d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_9.44.54.png)

JVMì„ ì‹œì‘í•˜ê³ , JAR íŒŒì¼ì— í¬í•¨ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰

```
park-yeonju@bag-yeonjuui-noteubug libs % java -jar ./demo-0.0.1-SNAPSHOT.jar
```

- +buildì™€ clean buildì˜ ì°¨ì´ì  ?
    
    ### `build`
    
    `./gradlew build` ëª…ë ¹ì–´ëŠ” Gradleì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” í”„ë¡œì íŠ¸ì˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ê³ , í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©°, JAR íŒŒì¼ ë˜ëŠ” WAR íŒŒì¼ë¡œ íŒ¨í‚¤ì§•í•˜ëŠ” ì¼ë ¨ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ì´ ì¡´ì¬í•˜ë©´ í•´ë‹¹ ê²°ê³¼ë¬¼ì„ ì¬ì‚¬ìš©í•˜ì—¬ ë¹Œë“œ ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    **ì¥ì **:
    
    - ë¹ ë¥¸ ë¹Œë“œ: ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ì„ ì¬ì‚¬ìš©í•˜ì—¬ ë¹Œë“œ ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ì¸í¬ë¦¬ë©˜í„¸ ë¹Œë“œ: ì†ŒìŠ¤ ì½”ë“œì˜ ë³€ê²½ëœ ë¶€ë¶„ë§Œ ë¹Œë“œí•˜ì—¬ íš¨ìœ¨ì„±ì„ ë†’ì…ë‹ˆë‹¤.
    
    **ë‹¨ì **:
    
    - ìºì‹œ ë¬¸ì œ: ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ì´ ì¡´ì¬í•˜ë©´ ìºì‹œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì˜ˆê¸°ì¹˜ ì•Šì€ ë¹Œë“œ ì˜¤ë¥˜ë‚˜ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    ### `clean build`
    
    `./gradlew clean build` ëª…ë ¹ì–´ëŠ” ë¨¼ì € `clean` ì‘ì—…ì„ ìˆ˜í–‰í•œ í›„ `build` ì‘ì—…ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. `clean` ì‘ì—…ì€ í”„ë¡œì íŠ¸ì˜ `build` ë””ë ‰í† ë¦¬ë¥¼ ì‚­ì œí•˜ì—¬ ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ì„ ëª¨ë‘ ì œê±°í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ `build` ì‘ì—…ì„ ìˆ˜í–‰í•˜ì—¬ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë¹Œë“œí•©ë‹ˆë‹¤.
    
    **ì¥ì **:
    
    - ê¹¨ë—í•œ ë¹Œë“œ: ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šìœ¼ë¯€ë¡œ, ë¹Œë“œ í™˜ê²½ì´ ê¹¨ë—í•©ë‹ˆë‹¤.
    - ë¬¸ì œ í•´ê²°: ìºì‹œ ë¬¸ì œë‚˜ ì´ì „ ë¹Œë“œ ê²°ê³¼ë¬¼ë¡œ ì¸í•œ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    **ë‹¨ì **:
    
    - ë¹Œë“œ ì‹œê°„: ëª¨ë“  íŒŒì¼ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë¹Œë“œí•˜ë¯€ë¡œ ë¹Œë“œ ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 5. SCPì™€ SSHë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì›ê²© ì„œë²„ì— ë°°í¬

1. í˜„ì¬ ë‚´ í‚¤ì˜ ìœ„ì¹˜ : `/Users/park-yeonju/Downloads/veronica-ssh-key.pem`
    
    jar íŒŒì¼ì´ ìˆëŠ” ìœ„ì¹˜ì—ì„œ scp, sshí•´ì£¼ê¸°
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 10.05.44.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/48b659d9-30d2-4ab4-9796-89f20ed978de/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.05.44.png)
    
    ### `SCP` :  íŒŒì¼ ì „ì†¡ ëª…ë ¹ì–´
    
    ```
    scp -i /Users/park-yeonju/Downloads/veronica-ssh-key.pem demo-0.0.1-SNAPSHOT.jar ubuntu@13.124.84.165:/home/ubuntu
    ```
    
    - **`scp`**: Secure Copyì˜ ì•½ìë¡œ, SSHë¥¼ í†µí•´ ì›ê²© ì„œë²„ì— íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ë³µì‚¬í•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.
    - **`i /Users/park-yeonju/Downloads/veronica-ssh-key.pem`**: SSH í‚¤ íŒŒì¼ì„ ì§€ì •. ì´ í‚¤ íŒŒì¼ì€ ì›ê²© ì„œë²„ì— ëŒ€í•œ ì¸ì¦ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
    - **`demo-0.0.1-SNAPSHOT.jar`**: ë¡œì»¬ ì»´í“¨í„°ì—ì„œ ì „ì†¡í•  íŒŒì¼ì…ë‹ˆë‹¤.
    - **`ubuntu@13.124.84.165:/home/ubuntu`**: íŒŒì¼ì„ ì „ì†¡í•  ì›ê²© ì„œë²„ì˜ ì‚¬ìš©ì ê³„ì •ê³¼ ëª©ì ì§€ ê²½ë¡œì…ë‹ˆë‹¤.
        - **`ubuntu`**: ì›ê²© ì„œë²„ì˜ ì‚¬ìš©ì ì´ë¦„ì…ë‹ˆë‹¤.
            
            [ì£¼ì˜] ì„œë²„ ì´ë¦„ í™•ì¸ ì˜ í•˜ê¸°
            
            ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-06-20 á„‹á…©á„Œá…¥á†« 10.13.15.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/94826345-4cf8-4a16-ac4e-477a2c54bf6a/8404faa6-9ba8-4185-be63-789906f7c10c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-06-20_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.13.15.png)
            
        - **`13.124.84.165`**: ì›ê²© ì„œë²„ì˜ IP ì£¼ì†Œì…ë‹ˆë‹¤.
        - **`/home/ubuntu`**: ì›ê²© ì„œë²„ì—ì„œ íŒŒì¼ì„ ì €ì¥í•  ê²½ë¡œì…ë‹ˆë‹¤.
    - ë¡œì»¬ì—ì„œ ë¹Œë“œí•œ JAR íŒŒì¼ì„ ì›ê²© ì„œë²„ë¡œ ì „ì†¡í•˜ì—¬, í•´ë‹¹ ì„œë²„ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„í•©ë‹ˆë‹¤.
    
    ### `SSH` : ì›ê²© ì ‘ì† ëª…ë ¹ì–´
    
    ```
    ssh -i /Users/park-yeonju/Downloads/veronica-ssh-key.pem ubuntu@13.124.84.165
    ```
    
    - **`ssh`**: Secure Shellì˜ ì•½ìë¡œ, ì›ê²© ì„œë²„ì— ì•ˆì „í•˜ê²Œ ì ‘ì†í•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.
    - **`i /Users/park-yeonju/Downloads/veronica-ssh-key.pem`**: SSH í‚¤ íŒŒì¼ì„ ì§€ì •í•©ë‹ˆë‹¤. ì´ í‚¤ íŒŒì¼ì€ ì›ê²© ì„œë²„ì— ëŒ€í•œ ì¸ì¦ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
    - **`ubuntu@13.124.84.165`**: ì ‘ì†í•  ì›ê²© ì„œë²„ì˜ ì‚¬ìš©ì ê³„ì •ê³¼ IP ì£¼ì†Œì…ë‹ˆë‹¤.
        - **`ubuntu`**: ì›ê²© ì„œë²„ì˜ ì‚¬ìš©ì ì´ë¦„ì…ë‹ˆë‹¤.
        - **`13.124.84.165`**: ì›ê²© ì„œë²„ì˜ IP ì£¼ì†Œì…ë‹ˆë‹¤.
    - ì›ê²© ì„œë²„ì— ì ‘ì†í•˜ì—¬, ì „ì†¡í•œ JAR íŒŒì¼ì„ ì‹¤í–‰í•˜ê±°ë‚˜ ì¶”ê°€ì ì¸ ì„¤ì • ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    

## 6.  ë¡œê·¸ ì €ì¥

(optional)

```bash
nohup java -jar demo-0.0.1-SNAPSHOT.jar > log.txt 2>&1 &
```

Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” ì„œë²„ê°€ ì¢…ë£Œë˜ë”ë¼ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê³„ì† ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥í•˜ë©°, ì‹¤í–‰ ë¡œê·¸ë¥¼ íŒŒì¼ì— ì €ì¥í•©ë‹ˆë‹¤. ê° ë¶€ë¶„ì˜ ì˜ë¯¸ë¥¼ ìì„¸íˆ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

- ëª…ë ¹ì–´ êµ¬ì„± ìš”ì†Œ
    - **`nohup`**: í„°ë¯¸ë„ì´ ì¢…ë£Œë˜ì–´ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê³„ì† ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.
    - **`java -jar demo-0.0.1-SNAPSHOT.jar`**: Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
    - **`> log.txt 2>&1`**: í‘œì¤€ ì¶œë ¥ê³¼ í‘œì¤€ ì˜¤ë¥˜ë¥¼ `log.txt` íŒŒì¼ì— ê¸°ë¡í•©ë‹ˆë‹¤.
    - **`&`**: ëª…ë ¹ì–´ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.
    
    ì´ ëª…ë ¹ì–´ëŠ” ì„œë²„ í™˜ê²½ì—ì„œ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì•ˆì •ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ë¡œê·¸ë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
    

## 7.  ì˜¤ë¥˜ ê²€ì‚¬

```bash
sudo nginx -t 
```

Nginx ì„¤ì • íŒŒì¼ì˜ êµ¬ë¬¸ì„ ê²€ì‚¬í•˜ì—¬ ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´

- ì„±ê³µì ì¸ ê²½ìš°ì˜ ì¶œë ¥

```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
```

- ì˜¤ë¥˜ê°€ ìˆëŠ” ê²½ìš°

```
nginx: [emerg] unknown directive "iphash" in /etc/nginx/sites-available/default:2
nginx: configuration file /etc/nginx/nginx.conf test failed
```

ì´ëŸ°ì‹ìœ¼ë¡œ ì˜¤ë¥˜ë©”ì„¸ì§€ í™•ì¸í•´ì„œ  okëœ° ë•Œê¹Œì§€  ìˆ˜ì •í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ etcíŒŒì¼ì´ ì˜¤ë¥˜ë‚  ê°€ëŠ¥ì„±ì´ í¼

**ì„¤ì • íŒŒì¼ ì—´ì–´ì„œ í™•ì¸í•˜ê¸° ë“±ë“±**

```
sudo vim /etc/nginx/sites-available/default
```

### ìˆ˜ì •ëœ ì„¤ì • íŒŒì¼ ì˜ˆì‹œ

```
upstream tomcat {
    ip_hash;
    server 127.0.0.1:8090 max_fails=5 fail_timeout=3s;
    keepalive 300;
}

server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /app/tomcat/webapps/ROOT;
    index index.jsp;

    server_name _;  # ì„œë²„ ì´ë¦„ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •

    charset utf-8;

    location / {
        proxy_pass <http://tomcat/>;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

```

## 8. Nginx ì›¹ ì„œë²„ë¥¼ ì¬ì‹œì‘

```bash
sudo systemctl restart nginx
```

- ì„±ê³µì ì´ë©´ : output ì—†ìŒ
- ì‹¤íŒ¨í•˜ë©´ : `sudo systemctl status nginx` ë¡œ ì˜¤ë¥˜ í™•ì¸



# ğŸ±ì˜¤ëŠ˜ì˜ íšŒê³ 
- ë°°í¬ ë­”ë§ì¸ì§€ í•˜ë‚˜ë„ ëª¨ë¥´ê² ìŒ.. ã… 

